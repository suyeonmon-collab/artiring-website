# Cursor AI 규칙 - ARTIRING 프로젝트

## 🚨 중요: 기록 페이지 관련 파일 삭제 금지

**절대 삭제하면 안 되는 파일들:**

### 기록 페이지 핵심 파일 (삭제 금지)
- `app/records/page.jsx` - 기록 목록 페이지
- `app/records/[slug]/page.jsx` - 기록 상세 페이지
- `components/records/BlogIframe.jsx` - HTML 파일 iframe 표시 컴포넌트
- `components/records/RecordList.jsx` - 기록 목록 컴포넌트
- `components/records/RecordToolbar.jsx` - 필터/정렬 툴바
- `components/records/TableOfContents.jsx` - 목차 컴포넌트
- `components/records/CopyLinkButton.jsx` - 링크 복사 버튼

### HTML 업로드 및 서빙 관련 파일 (삭제 금지)
- `app/api/upload-html/route.js` - HTML 파일 업로드 API
- `app/blog/[filename]/route.js` - HTML 파일 서빙 API

### 규칙
1. **위 파일들은 절대 삭제하지 마세요.** 이전에 실수로 삭제되어 복구한 경험이 있습니다.
2. 파일을 삭제하기 전에 반드시 사용자에게 확인하세요.
3. 기록 페이지 관련 파일을 수정할 때는 기존 기능을 깨뜨리지 않도록 주의하세요.
4. Git commit 전에 삭제된 파일이 없는지 확인하세요.

## 프로젝트 구조 규칙

### 테이블 명명 규칙
- 실제 데이터베이스에서는 `blog_posts`, `blog_categories`, `blog_tags`, `blog_admins` 테이블을 사용합니다.
- `posts`, `categories`, `tags`, `users`가 아닙니다.

### HTML 파일 처리
- `html_file` 필드가 있으면 `BlogIframe` 컴포넌트로 표시
- `html_file`이 없으면 `content_html` 필드 사용
- 외부 이미지 URL (pstatic.net, cdninstagram.com 등)은 자동으로 제거됨

### Storage 버킷
- `blog-html`: HTML 파일 저장 (공개)
- `post-images`: 게시글 이미지 (공개)
- `thumbnails`: 썸네일 이미지 (공개)

## 코딩 스타일

### 언어 및 프레임워크
- **언어**: JavaScript (TypeScript 사용 안 함)
- **프레임워크**: Next.js 14 (App Router)
- **스타일링**: Tailwind CSS + CSS Variables

### 컴포넌트 규칙
- 서버 컴포넌트를 기본으로 사용
- 클라이언트 컴포넌트는 `'use client'` 지시어 필수
- `BlogIframe`은 클라이언트 컴포넌트 (동적 import 사용)

### API Route 규칙
- 모든 API Route에 `export const runtime = 'nodejs'` 설정
- 동적 콘텐츠는 `export const dynamic = 'force-dynamic'` 설정
- 인증이 필요한 API는 `getAuthenticatedAdmin()` 사용

## 보안 규칙

### 파일 삭제 방지
- 기록 페이지 관련 파일은 절대 삭제하지 마세요
- Git에서 파일을 삭제하는 commit을 만들기 전에 사용자에게 확인하세요

### 외부 리소스
- 외부 이미지 URL은 자동으로 제거됨 (403 오류 방지)
- Supabase Storage URL은 프록시를 통해 서빙

## 데이터베이스

### 테이블 구조
- `blog_posts`: 게시글 테이블 (html_file 필드 포함)
- `blog_categories`: 카테고리 테이블
- `blog_tags`: 태그 테이블
- `blog_post_tags`: 게시글-태그 다대다 관계
- `blog_admins`: 관리자 테이블

### RLS 정책
- 발행된 글은 누구나 조회 가능
- 작성자는 자신의 모든 글 조회 가능
- 쓰기/수정/삭제는 서버에서만 (Service Role)

## 주의사항

1. **파일 삭제 금지**: 기록 페이지 관련 파일은 절대 삭제하지 마세요
2. **테이블 이름**: `posts`가 아닌 `blog_posts`를 사용합니다
3. **HTML 파일**: `html_file` 필드가 있으면 iframe으로 표시합니다
4. **외부 이미지**: 자동으로 제거되므로 수동 처리 불필요합니다








